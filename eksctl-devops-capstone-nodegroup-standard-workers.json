{"AWSTemplateFormatVersion":"2010-09-09","Description":"EKS nodes (AMI family: AmazonLinux2, SSH access: false, private networking: false) [created and managed by eksctl]","Resources":{"EgressInterCluster":{"Type":"AWS::EC2::SecurityGroupEgress","Properties":{"Description":"Allow control plane to communicate with worker nodes in group standard-workers (kubelet and workload TCP ports)","DestinationSecurityGroupId":{"Ref":"SG"},"FromPort":1025,"GroupId":{"Fn::ImportValue":"eksctl-devops-capstone-cluster::SecurityGroup"},"IpProtocol":"tcp","ToPort":65535}},"EgressInterClusterAPI":{"Type":"AWS::EC2::SecurityGroupEgress","Properties":{"Description":"Allow control plane to communicate with worker nodes in group standard-workers (workloads using HTTPS port, commonly used with extension API servers)","DestinationSecurityGroupId":{"Ref":"SG"},"FromPort":443,"GroupId":{"Fn::ImportValue":"eksctl-devops-capstone-cluster::SecurityGroup"},"IpProtocol":"tcp","ToPort":443}},"IngressInterCluster":{"Type":"AWS::EC2::SecurityGroupIngress","Properties":{"Description":"Allow worker nodes in group standard-workers to communicate with control plane (kubelet and workload TCP ports)","FromPort":1025,"GroupId":{"Ref":"SG"},"IpProtocol":"tcp","SourceSecurityGroupId":{"Fn::ImportValue":"eksctl-devops-capstone-cluster::SecurityGroup"},"ToPort":65535}},"IngressInterClusterAPI":{"Type":"AWS::EC2::SecurityGroupIngress","Properties":{"Description":"Allow worker nodes in group standard-workers to communicate with control plane (workloads using HTTPS port, commonly used with extension API servers)","FromPort":443,"GroupId":{"Ref":"SG"},"IpProtocol":"tcp","SourceSecurityGroupId":{"Fn::ImportValue":"eksctl-devops-capstone-cluster::SecurityGroup"},"ToPort":443}},"IngressInterClusterCP":{"Type":"AWS::EC2::SecurityGroupIngress","Properties":{"Description":"Allow control plane to receive API requests from worker nodes in group standard-workers","FromPort":443,"GroupId":{"Fn::ImportValue":"eksctl-devops-capstone-cluster::SecurityGroup"},"IpProtocol":"tcp","SourceSecurityGroupId":{"Ref":"SG"},"ToPort":443}},"NodeGroup":{"Type":"AWS::AutoScaling::AutoScalingGroup","Properties":{"DesiredCapacity":"3","LaunchTemplate":{"LaunchTemplateName":{"Fn::Sub":"${AWS::StackName}"},"Version":{"Fn::GetAtt":"NodeGroupLaunchTemplate.LatestVersionNumber"}},"MaxSize":"4","MinSize":"1","Tags":[{"Key":"Name","PropagateAtLaunch":"true","Value":"devops-capstone-standard-workers-Node"},{"Key":"kubernetes.io/cluster/devops-capstone","PropagateAtLaunch":"true","Value":"owned"}],"VPCZoneIdentifier":{"Fn::Split":[",",{"Fn::ImportValue":"eksctl-devops-capstone-cluster::SubnetsPublic"}]}},"UpdatePolicy":{"AutoScalingRollingUpdate":{"MaxBatchSize":"1","MinInstancesInService":"0"}}},"NodeGroupLaunchTemplate":{"Type":"AWS::EC2::LaunchTemplate","Properties":{"LaunchTemplateData":{"IamInstanceProfile":{"Arn":{"Fn::GetAtt":"NodeInstanceProfile.Arn"}},"ImageId":"ami-0392bafc801b7520f","InstanceType":"t3.medium","NetworkInterfaces":[{"AssociatePublicIpAddress":true,"DeviceIndex":0,"Groups":[{"Fn::ImportValue":"eksctl-devops-capstone-cluster::SharedNodeSecurityGroup"},{"Ref":"SG"}]}],"UserData":"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"},"LaunchTemplateName":{"Fn::Sub":"${AWS::StackName}"}}},"NodeInstanceProfile":{"Type":"AWS::IAM::InstanceProfile","Properties":{"Path":"/","Roles":[{"Ref":"NodeInstanceRole"}]}},"NodeInstanceRole":{"Type":"AWS::IAM::Role","Properties":{"AssumeRolePolicyDocument":{"Statement":[{"Action":["sts:AssumeRole"],"Effect":"Allow","Principal":{"Service":["ec2.amazonaws.com"]}}],"Version":"2012-10-17"},"ManagedPolicyArns":["arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy","arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy","arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly"],"Path":"/"}},"SG":{"Type":"AWS::EC2::SecurityGroup","Properties":{"GroupDescription":"Communication between the control plane and worker nodes in group standard-workers","Tags":[{"Key":"kubernetes.io/cluster/devops-capstone","Value":"owned"},{"Key":"Name","Value":{"Fn::Sub":"${AWS::StackName}/SG"}}],"VpcId":{"Fn::ImportValue":"eksctl-devops-capstone-cluster::VPC"}}}},"Outputs":{"FeatureLocalSecurityGroup":{"Value":true},"FeaturePrivateNetworking":{"Value":false},"FeatureSharedSecurityGroup":{"Value":true},"InstanceProfileARN":{"Export":{"Name":{"Fn::Sub":"${AWS::StackName}::InstanceProfileARN"}},"Value":{"Fn::GetAtt":"NodeInstanceProfile.Arn"}},"InstanceRoleARN":{"Export":{"Name":{"Fn::Sub":"${AWS::StackName}::InstanceRoleARN"}},"Value":{"Fn::GetAtt":"NodeInstanceRole.Arn"}}}}